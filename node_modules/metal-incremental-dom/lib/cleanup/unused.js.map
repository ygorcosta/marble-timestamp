{"version":3,"sources":["../../src/cleanup/unused.js"],"names":["disposeUnused","schedule","comps_","disposing_","i","length","comp","isDisposed","parent","portalElement","element","dispose","comps","push"],"mappings":"AAAA;;;;;QAWgBA,a,GAAAA,a;QA0BAC,Q,GAAAA,Q;;AAnChB;;AAEA,IAAIC,SAAS,EAAb;AACA,IAAIC,aAAa,KAAjB;;AAEA;;;;AAIO,SAASH,aAAT,GAAyB;AAC/B,KAAIG,UAAJ,EAAgB;AACf;AACA;AACDA,cAAa,IAAb;;AAEA,MAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,OAAOG,MAA3B,EAAmCD,GAAnC,EAAwC;AACvC,MAAME,OAAOJ,OAAOE,CAAP,CAAb;AACA,MAAI,CAACE,KAAKC,UAAL,EAAD,IAAsB,CAAC,mBAAQD,IAAR,EAAcE,MAAzC,EAAiD;AAChD;AACA;AACA,OAAI,CAACF,KAAKG,aAAV,EAAyB;AACxBH,SAAKI,OAAL,GAAe,IAAf;AACA;AACDJ,QAAKK,OAAL;AACA;AACD;AACDT,UAAS,EAAT;AACAC,cAAa,KAAb;AACA;;AAED;;;;;AAKO,SAASF,QAAT,CAAkBW,KAAlB,EAAyB;AAC/B,MAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIQ,MAAMP,MAA1B,EAAkCD,GAAlC,EAAuC;AACtC,MAAI,CAACQ,MAAMR,CAAN,EAASG,UAAT,EAAL,EAA4B;AAC3B,sBAAQK,MAAMR,CAAN,CAAR,EAAkBI,MAAlB,GAA2B,IAA3B;AACAN,UAAOW,IAAP,CAAYD,MAAMR,CAAN,CAAZ;AACA;AACD;AACD","file":"unused.js","sourcesContent":["'use strict';\n\nimport {getData} from '../data';\n\nlet comps_ = [];\nlet disposing_ = false;\n\n/**\n * Disposes all sub components that were not rerendered since the last\n * time this function was scheduled.\n */\nexport function disposeUnused() {\n\tif (disposing_) {\n\t\treturn;\n\t}\n\tdisposing_ = true;\n\n\tfor (let i = 0; i < comps_.length; i++) {\n\t\tconst comp = comps_[i];\n\t\tif (!comp.isDisposed() && !getData(comp).parent) {\n\t\t\t// Don't let disposing cause the element to be removed, since it may\n\t\t\t// be currently being reused by another component.\n\t\t\tif (!comp.portalElement) {\n\t\t\t\tcomp.element = null;\n\t\t\t}\n\t\t\tcomp.dispose();\n\t\t}\n\t}\n\tcomps_ = [];\n\tdisposing_ = false;\n}\n\n/**\n * Schedules the given components to be checked and disposed if not used\n * anymore when `disposeUnused` is called.\n * @param {!Array<!Component>} comps\n */\nexport function schedule(comps) {\n\tfor (let i = 0; i < comps.length; i++) {\n\t\tif (!comps[i].isDisposed()) {\n\t\t\tgetData(comps[i]).parent = null;\n\t\t\tcomps_.push(comps[i]);\n\t\t}\n\t}\n}\n"]}